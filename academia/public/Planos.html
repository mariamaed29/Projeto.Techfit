<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>TecFit | Planos</title>

  <link rel="icon" href="https://github.com/mariamaed29/Projeto.Techfit/blob/main/FOTOS/logoNormal.png?raw=true" type="image/x-icon">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="planos.css">
</head>

<body class="bg-dark text-light">

  <!-- NAVBAR -->
  <header>
    <nav class="navbar navbar-expand-md navbar-light bg-light fixed-top shadow-sm">
      <div class="container-fluid">
        <a class="navbar-brand d-flex align-items-center gap-2" href="#">
          <img src="https://github.com/mariamaed29/Projeto.Techfit/blob/main/FOTOS/logoNormal.png?raw=true" alt="Logo" width="40">
          <strong>TecFit</strong>
        </a>

        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarCollapse">
          <ul class="navbar-nav me-auto mb-2 mb-md-0">
            <li class="nav-item"><a class="nav-link" href="pÃ¡g.inicial.html"><i class="fa-solid fa-house"></i> InÃ­cio</a></li>
            <li class="nav-item"><a class="nav-link active" href="Planos.html"><i class="fa-solid fa-weight-hanging"></i> Planos</a></li>
            <li class="nav-item"><a class="nav-link" href="treinos.html"><i class="fa-solid fa-person-running"></i> Treino</a></li>
            <li class="nav-item"><a class="nav-link" href="loja.html"><i class="fa-solid fa-cart-shopping"></i> Loja</a></li>
            <li class="nav-item"><a class="nav-link" href="desafios.html"><i class="fa-solid fa-calendar-days"></i> Desafios</a></li>
          </ul>
        </div>
      </div>
    </nav>
  </header>

  <!-- CARROSSEL -->
  <main class="mt-5 pt-4">
    <div id="myCarousel" class="carousel slide" data-bs-ride="carousel">
      <div class="carousel-inner rounded-4 shadow-lg">
        <div class="carousel-item active">
          <img src="https://github.com/mariamaed29/Projeto.Techfit/blob/main/Novas_img/banne_luva_tam.png?raw=true" class="d-block w-100" alt="TechFit">
          <div class="carousel-caption">
            <a href="#Planos" class="btn btn-success btn-lg">Comece Agora</a>
          </div>
        </div>
        <div class="carousel-item">
          <img src="https://github.com/mariamaed29/Projeto.Techfit/blob/main/Novas_img/banner_desafio.png?raw=true" class="d-block w-100" alt="Planos">
          <div class="carousel-caption">
            <a href="desafios.html" class="btn btn-success btn-lg">Ver Desafios</a>
          </div>
        </div>
        <div class="carousel-item">
          <img src="https://github.com/mariamaed29/Projeto.Techfit/blob/main/Novas_img/banner_com_peso.png?raw=true" class="d-block w-100" alt="Eventos">
          <div class="carousel-caption">
            <a href="#Planos" class="btn btn-success btn-lg">Ver Planos</a>
          </div>
        </div>
      </div>

      <button class="carousel-control-prev" type="button" data-bs-target="#myCarousel" data-bs-slide="prev">
        <span class="carousel-control-prev-icon"></span>
      </button>
      <button class="carousel-control-next" type="button" data-bs-target="#myCarousel" data-bs-slide="next">
        <span class="carousel-control-next-icon"></span>
      </button>
    </div>
  </main>

  <!-- SEÃ‡ÃƒO PLANOS DINÃ‚MICOS -->
  <section id="Planos" class="container my-5 text-center text-light">
    <h2 class="mb-5 fw-bold">
      <i class="fa-solid fa-fire-flame-curved text-success"></i> Nossos Planos
    </h2>

    <!-- Loading -->
    <div id="loading" class="text-center">
      <div class="spinner-border text-success" role="status">
        <span class="visually-hidden">Carregando...</span>
      </div>
      <p class="mt-3">Carregando planos...</p>
    </div>

    <!-- Container dos Planos -->
    <div id="planos-container" class="row g-4 justify-content-center" style="display: none;">
      <!-- Planos serÃ£o carregados aqui via JavaScript -->
    </div>

    <!-- Mensagem se nÃ£o houver planos -->
    <div id="no-planos" class="alert alert-warning" style="display: none;">
      <i class="fa-solid fa-exclamation-triangle"></i> Nenhum plano disponÃ­vel no momento.
    </div>
  </section>

  <!-- RODAPÃ‰ -->
  <footer class="text-center py-4 bg-black border-top border-success mt-5">
    <p class="mb-1">Â© 2025 TecFit | Evolua todos os dias ðŸ’ª</p>
    <a href="#" class="text-success text-decoration-none">Voltar ao topo</a>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    // Ãcones para cada tipo de plano
    const icones = {
      'start': 'fa-dumbbell',
      'plus': 'fa-apple-whole',
      'premium': 'fa-medal',
      'black': 'fa-crown',
      'family': 'fa-people-group',
      'corporate': 'fa-briefcase'
    };

    // FunÃ§Ã£o para determinar o Ã­cone baseado no tÃ­tulo
    function getIcone(titulo) {
      const tituloLower = titulo.toLowerCase();
      for (let [key, icon] of Object.entries(icones)) {
        if (tituloLower.includes(key)) return icon;
      }
      return 'fa-star'; // Ã­cone padrÃ£o
    }

    // Carregar planos do banco de dados
fetch('views/admin/listaPlanos.php')

      .then(response => {
        if (!response.ok) throw new Error('Erro ao carregar planos');
        return response.json();
      })
      .then(planos => {
        const loading = document.getElementById('loading');
        const container = document.getElementById('planos-container');
        const noPlanos = document.getElementById('no-planos');

        loading.style.display = 'none';

        if (planos.length === 0) {
          noPlanos.style.display = 'block';
          return;
        }

        container.style.display = 'flex';

        planos.forEach(plano => {
          const icone = getIcone(plano.titulo);
          const valorFormatado = parseFloat(plano.valor).toLocaleString('pt-BR', {
            style: 'currency',
            currency: 'BRL'
          });

          // Processa os benefÃ­cios (separa por quebra de linha ou vÃ­rgula)
          const beneficiosArray = plano.beneficios
            .split(/\n|,/)
            .map(b => b.trim())
            .filter(b => b.length > 0);

          const beneficiosHTML = beneficiosArray
            .map(b => `<li>${b}</li>`)
            .join('');

          const card = `
            <div class="col-md-6 col-lg-4">
              <div class="card bg-dark border border-success shadow-lg h-100 p-4 rounded-4">
                <i class="fa-solid ${icone} fa-3x text-success mb-3"></i>
                <h4 class="fw-bold text-success">${plano.titulo}</h4>
                <p class="mb-2"><strong>${valorFormatado}/mÃªs</strong></p>
                <ul class="list-unstyled small text-start">
                  ${beneficiosHTML}
                </ul>
                <div class="mt-auto pt-3">
                  <a href="Assinar.html?plano_id=${plano.id}">
                    <button class="btn btn-success w-100 fw-bold">Assinar Agora</button>
                  </a>
                </div>
              </div>
            </div>
          `;

          container.innerHTML += card;
        });
      })
      .catch(error => {
        console.error('Erro:', error);
        document.getElementById('loading').innerHTML = `
          <div class="alert alert-danger">
            <i class="fa-solid fa-exclamation-circle"></i> 
            Erro ao carregar planos. Tente novamente mais tarde.
          </div>
        `;
      });
  </script>

</body>
</html>